# Open Meeting v0.1 MVP 测试计划

**版本**: v1.0
**日期**: 2026-02-13
**负责人**: 测试 Leader
**状态**: 执行中

---

## 1. 测试概述

### 1.1 项目背景
Open Meeting 是一个开源的企业级视频会议系统,v0.1 MVP 版本旨在实现基础的多人实时音视频通话能力,支持 Web 和 Electron 客户端。

### 1.2 测试目标
- 验证所有 P0/P1/P2 功能符合需求规范
- 确保测试覆盖率达标 (P0>90%, P1>80%, P2>70%)
- 验证性能指标达标 (音视频延迟<300ms, API响应<200ms)
- 验证安全性 (OWASP Top 10 漏洞扫描)
- 验证跨平台兼容性 (4个浏览器 + 3个操作系统)

### 1.3 测试范围

#### 包含范围 (In Scope)
- REQ-001: 用户认证系统 (P0)
- REQ-002: 会议管理 (P0)
- REQ-003: 实时音视频通话 (P0)
- REQ-004: 音视频控制 (P0)
- REQ-005: 屏幕共享 (P1)
- REQ-006: 文字聊天 (P1)
- REQ-007: 会议录制 (P1)
- REQ-008: 虚拟背景 (P2)
- REQ-009: 会议邀请链接 (P2)
- REQ-010: 会议统计 (P2)

#### 不包含范围 (Out of Scope)
- iOS/Android 原生客户端测试 (延后到 v0.2)
- 大型会议 (>4人) 测试
- 高级音视频功能 (美颜、特效、降噪)
- 第三方集成测试

---

## 2. 测试策略

### 2.1 测试分层

```
┌─────────────────────────────────────┐
│     E2E 测试 (10% 工作量)            │
│  - 完整业务流程                      │
│  - 跨平台互通                        │
│  - 用户验收场景                      │
├─────────────────────────────────────┤
│     集成测试 (20% 工作量)            │
│  - API 接口测试                      │
│  - WebSocket 信令测试                │
│  - 数据库集成测试                    │
│  - 跨模块交互测试                    │
├─────────────────────────────────────┤
│     单元测试 (70% 工作量)            │
│  - 领域层业务逻辑                    │
│  - 前端组件和 Hooks                  │
│  - 工具函数和值对象                  │
│  - 服务层逻辑                        │
└─────────────────────────────────────┘
```

### 2.2 测试类型

| 测试类型 | 覆盖范围 | 工具 | 执行时机 |
|---------|---------|------|---------|
| **单元测试** | 函数/类/组件 | Jest | 代码提交 |
| **集成测试** | 模块间交互/API | Jest + Supertest | PR 创建 |
| **E2E 测试** | 完整用户流程 | Playwright | 合并到主分支 |
| **性能测试** | 响应时间/吞吐量 | K6 + testrtc | Phase 5 |
| **安全测试** | 漏洞扫描 | OWASP ZAP | Phase 5 |
| **兼容性测试** | 跨浏览器/平台 | Playwright | Phase 3-5 |

### 2.3 测试环境

| 环境 | 用途 | 数据 | 访问方式 |
|-----|------|------|---------|
| **本地开发环境** | 开发者自测 | Mock 数据 | localhost |
| **集成测试环境** | 自动化测试 | 测试数据 | Docker Compose |
| **性能测试环境** | 性能/压力测试 | 模拟数据 | 独立服务器 |
| **UAT 环境** | 用户验收测试 | 真实数据 | 测试域名 |

---

## 3. 测试计划 (按 Phase 划分)

### Phase 1: 项目初始化 (Week 1)

**测试任务**:
- ✅ 测试框架搭建 (Jest/Playwright)
- ✅ 测试环境配置 (Docker Compose)
- ✅ CI/CD 测试流水线配置
- 🔲 测试文档编写

**交付物**:
- ✅ 测试框架代码
- 🔲 测试计划 v1.0
- 🔲 测试用例模板
- 🔲 缺陷管理流程

---

### Phase 2: 基础设施测试 (Week 2-3)

**测试重点**: REQ-001 用户认证 + REQ-002 会议管理

#### 单元测试
- [ ] 用户实体业务逻辑测试
- [ ] Email/Password 值对象验证测试
- [ ] JWT Token 生成与验证测试
- [ ] 会议实体业务逻辑测试
- [ ] 会议调度服务测试

#### 集成测试
- [ ] POST /api/v1/auth/register - 用户注册
- [ ] POST /api/v1/auth/login - 用户登录
- [ ] POST /api/v1/auth/refresh - Token 刷新
- [ ] GET /api/v1/meetings - 获取会议列表
- [ ] POST /api/v1/meetings - 创建会议
- [ ] POST /api/v1/meetings/:id/join - 加入会议
- [ ] 数据库事务一致性测试
- [ ] Redis 缓存正确性测试

#### E2E 测试
- [ ] 用户注册流程
- [ ] 用户登录流程
- [ ] 创建会议流程

**验收标准**:
- 单元测试覆盖率 >85%
- 集成测试覆盖率 >80%
- 所有 API 测试通过
- 无 P0 缺陷

---

### Phase 3: 音视频核心功能测试 (Week 4-6)

**测试重点**: REQ-003 音视频通话 + REQ-004 音视频控制

#### 功能测试
- [ ] WebRTC 连接建立流程
- [ ] 2人音视频通话
- [ ] 3人音视频通话
- [ ] 4人音视频通话
- [ ] 静音/取消静音功能
- [ ] 关闭/开启摄像头功能
- [ ] 摄像头切换 (前置/后置)
- [ ] 麦克风/扬声器切换
- [ ] 设备异常处理 (权限拒绝/设备占用)

#### 跨浏览器兼容性测试
| 浏览器 | 版本 | 测试场景 |
|--------|------|---------|
| Chrome | 90+ | 音视频通话、设备控制、屏幕共享 |
| Safari | 14+ | 音视频通话、设备控制 |
| Firefox | 88+ | 音视频通话、设备控制 |
| Edge | 90+ | 音视频通话、设备控制 |

#### 性能测试
- [ ] 音视频延迟测试 (LAN: <300ms)
- [ ] 音视频延迟测试 (WAN: <500ms)
- [ ] 多人并发测试 (2/3/4 人)
- [ ] 长时间通话稳定性 (1小时+)
- [ ] CPU/内存占用监控

#### 弱网测试
| 场景 | 丢包率 | 延迟 | 带宽 | 期望结果 |
|-----|-------|------|------|---------|
| 良好网络 | 0% | 20ms | 10Mbps | 流畅无卡顿 |
| 一般网络 | 5% | 100ms | 2Mbps | 轻微卡顿,可用 |
| 弱网环境 | 20% | 300ms | 1Mbps | 卡顿但可用 (>90%) |
| 极差网络 | 40% | 500ms | 500Kbps | 降级模式 |

#### Web/Electron 互通测试
- [ ] Web Chrome ↔ Electron Windows
- [ ] Web Chrome ↔ Electron macOS
- [ ] Web Chrome ↔ Electron Linux
- [ ] Web Safari ↔ Electron macOS
- [ ] Electron Windows ↔ Electron macOS
- [ ] Electron macOS ↔ Electron Linux
- [ ] Web (混合浏览器) ↔ Electron (混合OS)

**验收标准**:
- 单元测试覆盖率 >80%
- 音视频延迟达标
- 跨浏览器测试 100% 通过
- 弱网 20% 丢包率可用性 >90%
- Web/Electron 互通测试 100% 通过
- 无 P0 缺陷

---

### Phase 4: 辅助功能测试 (Week 7-8)

**测试重点**: REQ-005 屏幕共享 + REQ-006 聊天 + REQ-007 录制

#### 屏幕共享测试
- [ ] Web 端发起屏幕共享
- [ ] 屏幕共享清晰度验证 (1080p+)
- [ ] 屏幕共享帧率验证
- [ ] 停止屏幕共享
- [ ] 浏览器权限处理
- [ ] 同时只有一人可共享验证

#### 聊天功能测试
- [ ] 发送文本消息
- [ ] 接收文本消息
- [ ] 消息实时性 (<500ms)
- [ ] 消息历史记录
- [ ] Emoji 表情支持
- [ ] 长消息滚动显示

#### 录制功能测试
- [ ] 开始录制
- [ ] 停止录制
- [ ] 录制文件生成 (MP4)
- [ ] 录制文件音画同步
- [ ] 录制文件质量验证
- [ ] 长时间录制 (1小时+)
- [ ] 并发录制测试
- [ ] 转码性能测试
- [ ] 转码失败重试机制

**验收标准**:
- 单元测试覆盖率 >75%
- 屏幕共享清晰度达标
- 聊天消息延迟 <500ms
- 录制文件可正常播放
- 无 P0/P1 缺陷

---

### Phase 5: 集成测试与优化 (Week 9-10)

**测试重点**: 端到端完整流程 + 性能优化 + 安全评估

#### 端到端测试
- [ ] 完整用户流程: 注册 → 登录 → 创建会议 → 音视频通话 → 结束
- [ ] 异常场景: 网络断开恢复、服务崩溃恢复、权限拒绝处理
- [ ] 跨平台完整流程 (Web ↔ Electron)

#### 性能测试
- [ ] 并发用户压力测试 (目标 1000+)
- [ ] API 响应时间测试 (P95 <200ms)
- [ ] 数据库慢查询优化
- [ ] 服务端资源监控 (CPU/内存/带宽)

#### 安全测试
- [ ] OWASP Top 10 漏洞扫描
- [ ] Token 安全性测试
- [ ] API 越权访问测试
- [ ] XSS 攻击防护测试
- [ ] SQL 注入防护测试
- [ ] CSRF 防护测试
- [ ] 限流机制验证

#### 弱网综合测试
- [ ] 真实网络环境模拟
- [ ] 不同地域用户互通测试

**验收标准**:
- P0 功能通过率 100%
- P1 功能通过率 >95%
- 无 P0/P1 遗留缺陷
- 性能指标全部达标
- 安全漏洞扫描通过
- 弱网测试达标

---

### Phase 6: 发布准备 (Week 11-12)

**测试任务**:
- [ ] 回归测试 (全功能验证)
- [ ] 版本升级测试
- [ ] 安装/卸载测试 (Electron)
- [ ] 用户验收测试 (UAT)
- [ ] 发布检查清单验证

**交付物**:
- 最终测试报告
- 已知问题清单
- 性能测试报告
- 安全评估报告
- UAT 通过确认

---

## 4. 测试覆盖率目标

### 4.1 代码覆盖率

| 功能优先级 | 分支覆盖率 | 函数覆盖率 | 行覆盖率 | 语句覆盖率 |
|----------|----------|----------|---------|----------|
| P0 | >90% | >90% | >90% | >90% |
| P1 | >80% | >80% | >80% | >80% |
| P2 | >70% | >70% | >70% | >70% |

### 4.2 功能覆盖率

| 测试类型 | 目标覆盖率 |
|---------|----------|
| 单元测试 | >80% |
| 集成测试 | >60% |
| E2E 测试 | 关键路径 100% |

### 4.3 覆盖率执行机制

**CI/CD 强制检查**:
- 代码提交触发覆盖率检查
- 覆盖率未达标 → 阻塞 PR 合并
- 新代码覆盖率要求 ≥80%

**每日覆盖率报告**:
- 自动生成覆盖率趋势图
- 邮件通知未达标模块
- Dashboard 实时展示

**Code Review 检查**:
- 审查测试用例质量
- 确保测试覆盖核心业务逻辑

---

## 5. 测试工具

### 5.1 测试框架

| 测试类型 | 工具 | 用途 |
|---------|------|------|
| 单元测试 | Jest | 前端/后端单元测试 |
| 单元测试 | React Testing Library | React 组件测试 |
| 集成测试 | Supertest | HTTP API 测试 |
| 集成测试 | Socket.IO Client | WebSocket 测试 |
| 集成测试 | Pact | 契约测试 |
| E2E 测试 | Playwright | 跨浏览器自动化 |
| 覆盖率 | Istanbul (nyc) | 代码覆盖率统计 |

### 5.2 性能测试工具

| 工具 | 用途 |
|------|------|
| K6 | API 压力测试 |
| testrtc.com | WebRTC 性能分析 |
| WebRTC Internals | 浏览器 WebRTC 调试 |
| Lighthouse | 前端性能评分 |

### 5.3 弱网模拟工具

| 工具 | 平台 |
|------|------|
| Network Link Conditioner | macOS |
| tc (Traffic Control) | Linux |
| Clumsy | Windows |
| Toxiproxy | 服务端故障注入 |

### 5.4 安全测试工具

| 工具 | 用途 |
|------|------|
| OWASP ZAP | 漏洞自动扫描 |
| Burp Suite | 手工渗透测试 |

### 5.5 监控工具

| 工具 | 用途 |
|------|------|
| Prometheus + Grafana | 性能监控 |
| Sentry | 错误追踪 |

---

## 6. 缺陷管理

### 6.1 缺陷优先级

| 优先级 | 定义 | 响应时间 | 修复时间 |
|-------|------|---------|---------|
| **P0** | 阻塞功能,系统崩溃 | 立即 | 24小时内 |
| **P1** | 核心功能异常 | 4小时内 | 3天内 |
| **P2** | 一般功能缺陷 | 1天内 | 1周内 |
| **P3** | 优化建议 | 1周内 | 下个版本 |

### 6.2 缺陷生命周期

```
新建 → 已确认 → 修复中 → 待验证 → 已关闭
          ↓
        无法重现/延期
```

### 6.3 缺陷统计

**发布标准**:
- P0 缺陷: 0 个
- P1 缺陷: <5 个 (非关键路径)
- P2 缺陷: <10 个

---

## 7. 测试报告

### 7.1 每日报告
- 测试执行进度
- 测试覆盖率趋势
- 新增/关闭缺陷统计

### 7.2 每周报告
- 功能测试通过率
- 性能指标达成情况
- 风险评估与应对

### 7.3 里程碑报告
- Phase 完成后综合测试报告
- 质量评估与建议

---

## 8. 风险管理

### 8.1 测试风险

| 风险 | 影响 | 概率 | 应对措施 |
|-----|------|------|---------|
| WebRTC 浏览器兼容性问题 | 高 | 中 | Phase 2 启动兼容性预研测试 |
| 测试覆盖率执行不到位 | 中 | 中 | CI/CD 强制检查,Code Review |
| 跨 Team 集成测试协调 | 中 | 中 | Mock 数据,接口契约明确 |
| 端到端测试环境复杂 | 中 | 低 | Docker Compose 快速搭建 |

### 8.2 应对策略
- 提前启动高风险领域测试
- 建立自动化测试环境
- 定期同步测试进展
- 及时上报阻塞问题

---

## 9. 团队协作

### 9.1 与后端团队
- 接口契约对齐 (OpenAPI 规范)
- TDD 同步开发测试用例
- API Mock 数据提供

### 9.2 与前端团队
- WebRTC 测试环境搭建
- 组件测试用例编写
- 兼容性问题反馈

### 9.3 与客户端团队
- Electron 测试用例编写
- 跨平台互通测试
- 系统集成测试

### 9.4 与运维团队
- CI/CD 测试流水线配置
- 测试环境部署脚本
- 监控指标接入

---

## 10. 附录

### 10.1 参考文档
- [v0.1 MVP 版本规划](../versions/v0.1/plan.md)
- [v0.1 MVP 需求列表](../versions/v0.1/requirements.md)
- [测试用例模板](./test_case_template.md)
- [缺陷管理流程](./bug_management.md)

### 10.2 联系方式
- **测试 Leader**: test-leader@openmeeting.dev
- **测试 Team**: test-team@openmeeting.dev

---

**文档版本历史**:
- v1.0 (2026-02-13): 初版发布
