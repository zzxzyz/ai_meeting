# 缺陷管理流程

**版本**: v1.0
**日期**: 2026-02-13
**负责人**: 测试 Leader

---

## 1. 缺陷管理概述

### 1.1 目的
建立统一的缺陷管理流程,确保:
- 缺陷被及时发现、记录和修复
- 缺陷状态可追踪
- 缺陷数据可用于质量分析
- 团队协作高效

### 1.2 适用范围
本流程适用于 Open Meeting 项目的所有缺陷,包括但不限于:
- 功能缺陷
- 性能问题
- 安全漏洞
- 兼容性问题
- 用户体验问题

---

## 2. 缺陷分类

### 2.1 按优先级分类

| 优先级 | 定义 | 示例 | 响应时间 | 修复时间 |
|-------|------|------|---------|---------|
| **P0** | 系统崩溃,阻塞核心功能 | 无法登录、服务器崩溃、数据丢失 | 立即 | 24小时内 |
| **P1** | 核心功能异常,严重影响使用 | 音视频无法连接、消息发送失败 | 4小时内 | 3天内 |
| **P2** | 一般功能缺陷,可绕过 | UI 显示错误、功能不完善 | 1天内 | 1周内 |
| **P3** | 优化建议,不影响使用 | 性能优化建议、UI 美化 | 1周内 | 下个版本 |

### 2.2 按类型分类

| 类型 | 说明 | 示例 |
|-----|------|------|
| **功能缺陷** | 功能不符合需求或设计 | 按钮点击无响应 |
| **性能问题** | 响应慢、资源占用高 | API 响应超过 200ms |
| **安全漏洞** | 存在安全风险 | SQL 注入、XSS 攻击 |
| **兼容性问题** | 跨浏览器/平台不一致 | Safari 无法播放视频 |
| **UI/UX 问题** | 界面显示或交互问题 | 按钮位置不合理 |
| **数据问题** | 数据错误或丢失 | 会议记录未保存 |

### 2.3 按严重程度分类

| 严重程度 | 定义 | 影响范围 |
|---------|------|---------|
| **致命 (Critical)** | 系统崩溃,无法使用 | 所有用户 |
| **严重 (Major)** | 核心功能不可用 | 大部分用户 |
| **一般 (Normal)** | 功能异常,可绕过 | 部分用户 |
| **轻微 (Minor)** | 小问题,不影响使用 | 个别场景 |

---

## 3. 缺陷生命周期

### 3.1 缺陷状态

```
[新建 New]
    ↓
[已确认 Confirmed] ──→ [无法重现 Cannot Reproduce]
    ↓                          ↓
[修复中 In Progress]       [已关闭 Closed]
    ↓
[待验证 Ready for Test]
    ↓
[已修复 Fixed] ──→ [重新打开 Reopened] → [修复中]
    ↓
[已关闭 Closed]
    ↓
[延期 Deferred] → [已关闭 Closed]
```

### 3.2 状态说明

| 状态 | 说明 | 负责人 | 下一步 |
|-----|------|--------|--------|
| **新建 (New)** | 缺陷刚被提交 | 测试人员 | 等待确认 |
| **已确认 (Confirmed)** | 缺陷已被确认存在 | 开发 Leader | 分配给开发人员 |
| **无法重现 (Cannot Reproduce)** | 无法复现该缺陷 | 测试人员 | 重新验证或关闭 |
| **修复中 (In Progress)** | 开发人员正在修复 | 开发人员 | 修复完成后更新状态 |
| **待验证 (Ready for Test)** | 修复完成,等待测试 | 测试人员 | 验证修复结果 |
| **已修复 (Fixed)** | 测试验证通过 | 测试人员 | 关闭缺陷 |
| **重新打开 (Reopened)** | 验证未通过,缺陷仍存在 | 开发人员 | 重新修复 |
| **已关闭 (Closed)** | 缺陷已解决并验证通过 | - | - |
| **延期 (Deferred)** | 延期到后续版本修复 | 开发 Leader | 记录到技术债务 |

### 3.3 状态流转规则

**从新建到已确认**:
- 测试 Leader 或开发 Leader 确认缺陷存在
- 分配优先级和严重程度
- 分配给相应的开发人员

**从已确认到修复中**:
- 开发人员接受任务
- 开始修复工作

**从修复中到待验证**:
- 开发人员完成修复
- 代码已提交并部署到测试环境
- 通知测试人员验证

**从待验证到已修复或重新打开**:
- 测试人员验证修复结果
- 通过 → 已修复 → 已关闭
- 未通过 → 重新打开 → 修复中

---

## 4. 缺陷报告

### 4.1 缺陷报告模板

```markdown
# 缺陷报告

## 基本信息
- **缺陷ID**: BUG-001
- **标题**: 用户登录失败返回 500 错误
- **报告人**: 测试工程师
- **报告日期**: 2026-02-13
- **优先级**: P1
- **严重程度**: Major
- **所属模块**: 用户认证 (REQ-001)
- **影响版本**: v0.1.0

## 环境信息
- **测试环境**: 集成测试环境
- **浏览器**: Chrome 120.0.6099.109
- **操作系统**: macOS 14.2
- **后端版本**: commit abc123

## 缺陷描述
用户使用正确的邮箱和密码登录时,后端返回 500 Internal Server Error,无法登录系统。

## 复现步骤
1. 访问登录页面 http://localhost:3000/login
2. 输入邮箱: test@example.com
3. 输入密码: SecurePass123
4. 点击"登录"按钮

## 预期结果
- 登录成功
- 跳转到首页 /dashboard
- 显示用户名

## 实际结果
- 页面显示"登录失败"
- 控制台报错: POST /api/v1/auth/login 500 (Internal Server Error)
- 未跳转到首页

## 错误日志
```
[2026-02-13 10:30:15] ERROR: Database connection failed
Error: connect ECONNREFUSED 127.0.0.1:5432
    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1595:16)
```

## 附件
- 截图: login-error.png
- 日志文件: server.log
- 请求/响应: network-trace.har

## 附加信息
- 该问题在开发环境中无法重现
- 可能与数据库连接池配置有关
```

### 4.2 缺陷报告规范

**标题规范**:
- 简洁明了,一句话描述问题
- 格式: `[模块] 操作 + 结果`
- 示例:
  - ❌ "登录有问题"
  - ✅ "用户登录失败返回 500 错误"

**描述规范**:
- 清晰描述问题现象
- 避免主观判断 (如"可能是 XX 导致的")
- 提供足够的上下文信息

**复现步骤规范**:
- 步骤编号,逐步描述
- 包含具体的测试数据
- 确保他人可以按步骤复现

**附件规范**:
- 必须包含截图 (问题现象)
- 提供错误日志 (如有)
- 提供网络请求记录 (API 问题)

---

## 5. 缺陷处理流程

### 5.1 缺陷提交流程

```
[发现缺陷]
    ↓
[检查是否已存在] ──YES→ [在已有缺陷下评论]
    ↓ NO
[填写缺陷报告]
    ↓
[提交到缺陷管理系统]
    ↓
[通知相关人员]
```

### 5.2 缺陷分配流程

**测试 Leader 职责**:
1. 审查新提交的缺陷
2. 确认缺陷的有效性
3. 评估优先级和严重程度
4. 分配给相应的开发 Leader

**开发 Leader 职责**:
1. 审查分配的缺陷
2. 评估修复成本
3. 分配给具体的开发人员
4. 跟踪修复进度

**开发人员职责**:
1. 分析缺陷原因
2. 制定修复方案
3. 编写修复代码
4. 编写或更新测试用例
5. 提交代码并通知测试验证

### 5.3 缺陷验证流程

**测试人员验证步骤**:
1. 确认代码已部署到测试环境
2. 按照复现步骤验证问题是否修复
3. 执行回归测试,确保未引入新问题
4. 更新缺陷状态:
   - 验证通过 → 已修复 → 已关闭
   - 验证未通过 → 重新打开 → 附上验证结果

**验证不通过的处理**:
- 详细说明验证失败的原因
- 提供新的截图和日志
- 如问题变化,可创建新缺陷关联

---

## 6. 缺陷优先级判定

### 6.1 P0 缺陷判定标准

满足以下**任一**条件即为 P0:
- ❌ 系统无法启动或崩溃
- ❌ 数据丢失或损坏
- ❌ 安全漏洞 (SQL 注入、XSS 等)
- ❌ P0 功能完全不可用 (用户无法登录、无法创建会议)
- ❌ 影响 >50% 用户的关键功能

**处理要求**:
- 立即响应
- 24小时内修复
- 修复后立即发布热修复版本

### 6.2 P1 缺陷判定标准

满足以下**任一**条件即为 P1:
- ⚠️ P0 功能部分不可用 (登录有时失败)
- ⚠️ P1 功能完全不可用 (屏幕共享失败)
- ⚠️ 性能严重不达标 (延迟 >1s)
- ⚠️ 影响 10-50% 用户的重要功能
- ⚠️ 有明显的绕过方案,但用户体验差

**处理要求**:
- 4小时内响应
- 3天内修复
- 随下一个版本发布

### 6.3 P2 缺陷判定标准

满足以下条件即为 P2:
- ℹ️ P1/P2 功能部分不可用,可绕过
- ℹ️ UI 显示错误,不影响功能
- ℹ️ 性能未达标,但可接受
- ℹ️ 影响 <10% 用户的功能

**处理要求**:
- 1天内响应
- 1周内修复
- 随计划版本发布

### 6.4 P3 缺陷判定标准

满足以下条件即为 P3:
- 💡 优化建议
- 💡 UI 美化
- 💡 性能提升建议
- 💡 代码重构建议

**处理要求**:
- 1周内响应
- 视情况安排修复
- 可延期到后续版本

---

## 7. 缺陷会议

### 7.1 每日缺陷评审会

**时间**: 每天上午 10:00
**时长**: 15-30 分钟
**参与人**: 测试 Leader + 开发 Leader

**议程**:
1. 新增缺陷评审 (优先级/分配)
2. P0/P1 缺陷进度跟踪
3. 阻塞问题讨论
4. 待验证缺陷分配

### 7.2 每周缺陷分析会

**时间**: 每周五下午 3:00
**时长**: 1 小时
**参与人**: 所有 Team Leader

**议程**:
1. 本周缺陷统计分析
2. 缺陷趋势分析
3. 质量问题根因分析
4. 改进措施讨论

---

## 8. 缺陷统计与分析

### 8.1 缺陷统计指标

| 指标 | 说明 | 计算方式 |
|-----|------|---------|
| **缺陷密度** | 每千行代码的缺陷数 | 缺陷总数 / 代码行数 × 1000 |
| **缺陷发现率** | 测试期间发现的缺陷数 | 按时间段统计 |
| **缺陷修复率** | 已修复缺陷占比 | 已修复数 / 总缺陷数 × 100% |
| **缺陷重开率** | 验证未通过重开的缺陷占比 | 重开数 / 修复数 × 100% |
| **缺陷遗留数** | 未解决的缺陷数 | 按优先级分类统计 |
| **缺陷修复周期** | 从发现到修复的平均时间 | 总修复时间 / 已修复数 |

### 8.2 缺陷分析维度

**按模块分析**:
```
用户认证: 10 个缺陷 (P0:1, P1:3, P2:6)
会议管理: 15 个缺陷 (P0:0, P1:5, P2:10)
音视频:   20 个缺陷 (P0:2, P1:8, P2:10)
```

**按类型分析**:
```
功能缺陷:   30 个 (66.7%)
性能问题:   8 个  (17.8%)
兼容性问题: 5 个  (11.1%)
UI/UX 问题: 2 个  (4.4%)
```

**按严重程度分析**:
```
致命: 3 个  (6.7%)
严重: 16 个 (35.6%)
一般: 20 个 (44.4%)
轻微: 6 个  (13.3%)
```

### 8.3 质量趋势分析

**缺陷发现趋势**:
- 绘制缺陷发现曲线
- 分析高峰期原因
- 预测后续缺陷数

**缺陷修复趋势**:
- 绘制缺陷修复曲线
- 分析修复速度
- 识别瓶颈环节

**缺陷遗留趋势**:
- 绘制遗留缺陷曲线
- 评估发布风险
- 制定应对措施

---

## 9. 发布标准

### 9.1 缺陷数量标准

| 优先级 | 遗留数量限制 | 说明 |
|-------|------------|------|
| **P0** | 0 | 不允许有任何 P0 缺陷 |
| **P1** | <5 | 最多 5 个,且必须在非关键路径 |
| **P2** | <10 | 最多 10 个,不影响核心功能 |
| **P3** | 无限制 | 可延期到后续版本 |

### 9.2 发布检查清单

**缺陷检查**:
- [ ] P0 缺陷数 = 0
- [ ] P1 缺陷数 < 5
- [ ] P2 缺陷数 < 10
- [ ] 所有已知缺陷已记录在发布说明中

**回归测试**:
- [ ] 核心功能回归测试通过
- [ ] 缺陷修复验证通过
- [ ] 无新增 P0/P1 缺陷

**文档更新**:
- [ ] 已知问题清单已更新
- [ ] 发布说明已包含缺陷修复列表

---

## 10. 缺陷管理工具

### 10.1 推荐工具

| 工具 | 类型 | 优势 | 适用场景 |
|-----|------|------|---------|
| **GitHub Issues** | 免费 | 与代码仓库集成,简单易用 | 小团队,开源项目 |
| **Jira** | 商业 | 功能强大,流程可定制 | 大团队,企业项目 |
| **Linear** | 商业 | 现代化界面,速度快 | 中小团队,敏捷开发 |
| **Notion** | 免费/商业 | 灵活可定制,协作方便 | 灵活需求 |

### 10.2 GitHub Issues 使用规范

**Issue 标签 (Labels)**:
```
优先级:
- priority: P0 (红色)
- priority: P1 (橙色)
- priority: P2 (黄色)
- priority: P3 (绿色)

类型:
- bug: 功能缺陷
- bug: 性能
- bug: 安全
- bug: 兼容性
- bug: UI/UX

状态:
- status: 已确认
- status: 修复中
- status: 待验证
- status: 已修复
- status: 无法重现
- status: 延期

模块:
- module: 用户认证
- module: 会议管理
- module: 音视频
- module: 聊天
```

**Issue 模板**:
在 `.github/ISSUE_TEMPLATE/bug_report.md` 中创建模板

---

## 11. 最佳实践

### 11.1 缺陷预防

**开发阶段**:
- 采用 TDD (测试驱动开发)
- Code Review 强制执行
- 静态代码分析工具集成
- 单元测试覆盖率 >80%

**测试阶段**:
- 左移测试 (提前介入)
- 自动化测试覆盖
- 探索性测试
- 用户验收测试

### 11.2 缺陷沟通

**原则**:
- 对事不对人
- 客观描述问题
- 提供详细信息
- 及时沟通

**禁忌**:
- ❌ "这个功能写得太烂了"
- ❌ "怎么这么简单的问题都有 bug"
- ❌ "上次就说过这个问题"
- ✅ "在 XX 场景下,功能表现为 YY,与预期不符"

### 11.3 缺陷根因分析 (5 Why 分析法)

**示例**:
```
问题: 用户登录失败

Why 1: 为什么登录失败?
→ 数据库连接失败

Why 2: 为什么数据库连接失败?
→ 连接池已满

Why 3: 为什么连接池已满?
→ 连接未正确释放

Why 4: 为什么连接未正确释放?
→ 代码中缺少 finally 块关闭连接

Why 5: 为什么代码中缺少 finally 块?
→ 开发规范未明确要求,Code Review 未检查

根本原因: 开发规范不完善 + Code Review 检查不严格

改进措施:
1. 完善开发规范,明确数据库连接管理要求
2. Code Review 检查清单增加连接管理检查项
3. 引入静态代码分析工具自动检测
```

---

## 12. 附录

### 12.1 缺陷报告示例

参见: `docs/testing/bug-reports/` 目录下的示例文件

### 12.2 相关文档

- [测试计划](./test_plan.md)
- [测试用例模板](./test_case_template.md)
- [测试环境配置](./environment_setup.md)

### 12.3 联系方式

- **测试 Leader**: test-leader@openmeeting.dev
- **开发 Leader**: dev-leader@openmeeting.dev

---

**文档版本历史**:
- v1.0 (2026-02-13): 初版发布
